.

Improved the types

Improved refresh logic